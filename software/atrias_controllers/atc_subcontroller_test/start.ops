# Clean up the controller namespace
atrias_cm.resetControllerNames()

# Set up the component
import("atc_subcontroller_test")
loadComponent("controller", "ATCSubcontrollerTest")

controller.subcontrollerName = "subcontroller"

# This needs tweaked for each subcontroller
loadComponent(controller.subcontrollerName, "ASCSpringTorque")

# Connect RTOps with this controller (so they can see each other's operations)
connectPeers("atrias_rt", "controller")
connectPeers("controller", controller.subcontrollerName)
addPeer("subcontroller", "Deployer")

# Set up the gui connection
var ConnPolicy gui_policy
gui_policy.transport = 3
gui_policy.name_id = "/atc_subcontroller_test_status"
stream("controller.gui_data_out", gui_policy)

gui_policy.name_id = "/atc_subcontroller_test_input"
stream("controller.gui_data_in", gui_policy)

#gui_policy.name_id = "/subcontroller"
#stream(controller.subcontrollerName, gui_policy)

subcontroller.configure()

# Configure the component
controller.configure()

# Start the component
controller.start()
